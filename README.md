# GOscore_Analysis
 This repository contains a modular pipeline for GO enrichment and GOscore analysis based on time-series RNA-seq data.
 
## Contents

- `data/`: Example gene expression matrix
- `scripts/`: All analysis modules
- `main.R`: Main script to run the pipeline
- `output/`: Output directory for results
- `README.md`: Project overview

## Run the pipeline

```bash
Rscript main.R
```

## Dependencies

- R >= 4.1.0
- Packages: clusterProfiler, org.Mm.eg.db, dplyr, reshape2, stringr, tidyr

## License

MIT License

## Scripts
### `01_data_preparation.R`

Loads a gene expression matrix from a CSV file. The matrix should contain gene symbols as the first column, and expression values across samples as other columns.

**Expected format:**
head(expr)
Gene   W0   W2   W5   W8  W11 
Gnai3 2168 2103 3671 2863 2229 
Pbsn    1    8    2    0    0   
Cdc45  213  448  432  337  250  
H19     0    1  1792 2377 330  
Scml2  16   16   33    2    7 
Apoh    4    2    7    8    6  

**Use cases:** 
  load_expression_matrix(filepath): Loads the matrix with gene symbols as row names.

### `02_GO_enrichment.R`

Performs Gene Ontology enrichment analysis using `clusterProfiler::enrichGO()` .

**Workflow:**
- Reads gene symbols from `data/example_counts.csv`
- Converts SYMBOL → ENTREZID via `org.Mm.eg.db`
- Performs GO enrichment separately for:
  - Biological Process (BP)
  - Cellular Component (CC)
  - Molecular Function (MF)
- Optionally filters out GO terms with gene count < 3 (default)

**Output:**
- `results/GO_enrichment_combined.csv` (merged results for all categories)
- Separate outputs: `GO_enrichment_BP.csv`, `GO_enrichment_CC.csv`, `GO_enrichment_MF.csv`

**Use cases:**  Prepares functional enrichment input for downstream GO matrix construction and GOscore calculation.


### `03_GO_matrix_building.R`

Defines the `build_GO_matrix()` function that constructs binary gene-by-GO-term matrices from
GO enrichment results (`clusterProfiler::enrichGO`). 

**Key features:**
- Input: enrichGO() results
- Categories supported: BP, CC, MF
- Output:
   Rows: genes
   Columns: enriched GO terms
   Values: 1/0 indicating gene–term membership

**Use cases:**  
  Input for GOscore analysis


### `04_GOscore_analysis.R`

Defines the `run_GOscore_analysis()` function to evaluate the temporal dynamics of enriched GO terms.

**Key features:**
- Performs Welch’s t-tests comparing W0 vs. W2/W5/W8/W11 for each GO term.
- Input: merged gene expression + GO matrix
- Output: summary table of GO terms with p-values for each comparison.

**Use cases:** 
  Identify  time-varying functional signatures in disease progression, treatment response, or developmental stages.

**Expected Output format:**
head(goscore_result)
GO           W0_W2     W0_W5     W0_W8     W0_W11  
GO:xxxx      0.023     0.005     0.031     0.0002
GO:yyyy      0.4       0.03      NA        0.1
...


### Downstream analysis (optional)

The GOscore tables generated by this pipeline can be:
- Exported as CSV and visualized by -log10(p value) ranking (e.g., using Excel scatterplots).
- Further processed by **KOBAS-i** for secondary enrichment.
- Clustered into functional modules with **cirFunMap**.
- Manually annotated at Level 2 using **QuickGO**.
